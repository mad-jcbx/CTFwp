# -*- coding:utf8 -*-
from Crypto.Util.number import *
import gmpy2
import os
import libnum
import random
import signal

n=33774167600199691072470424898842928168570559940362770786060699320989546851695106466924163816843729828399984649770900793014896037884774039660562546937090412844276185560384964983508291174867808082182386566813393157054259464108858158903739578119760394228341564696225513954400995543629624209942565369972555679980359992955514826589781286738100616149226885302403505062415492679633217275379153421830105021673417544608398249866398042786421630495968810854036782025120509999022773806069591080190166920079688217334968528641747739241234353918892029263544388161160427668518991666960251381106788899451912317001247537576428186291689
e=65537
d=11264411788839355592444856301614488363956471904061056255881635805090094375457400203763192894221130759558216953395674955120307575813439598378024263407707436165069943146297428393266768825247731038349979486052262807679509336199267919454932934045527300563698215071335234814155316242621058729891886931914187742084664702392602429806835617468209844338711315548455315452692700616464465563108767921693721150452939650725153874644898636543732854250641129411206109642819488878782249575130672657182665780011560050159281212359222980210472602178746411982328739935093883590670811966243661382699777078747677158108250557964576989602089
    
print("n=%s"%(n))
list1=[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 
  31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 
  73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 
  127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 
  179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 
  233, 239, 241, 251, 257, 263, 269, 271, 277, 281]
list=[2,3,7,11,31,61,73,331]
for a in list:
    t=e*d-1
    print("Trying... a=%s"%(a))
    while t%2==0:
        t=t/2
        print("t=%s"%(t))
        ans=pow(a,t,n)
        if ans==1:
            print("a^t mod n =1")
            continue
        else:
            print("a^t mod n =%s"%(ans))
            if gmpy2.gcd(ans+1,n)==n or gmpy2.gcd(ans+1,n)==1:
                continue
            else:
                print("Get!!! gcd(x+1,n)=%s"%(gmpy2.gcd(ans+1,n)))
                break
    print("\n")  
    
